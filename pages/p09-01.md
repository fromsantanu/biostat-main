## **ğŸ§¬ Hardy-Weinberg Equilibrium and Genetic Association**

### **ğŸ“– Introduction**

The **Hardy-Weinberg Equilibrium (HWE)** is a foundational concept in population genetics. It states that **allele and genotype frequencies remain constant** from generation to generation **in the absence of evolutionary influences**, assuming:

âœ… **Random mating**
âœ… **No mutation, migration, selection, or genetic drift**

---

### **ğŸ” Why is HWE Important in Biostatistics?**

âœ… Used to **check validity of genotype data** in genetic association studies
âœ… Deviation from HWE suggests **genotyping errors, selection bias, or population stratification**

---

### **ğŸ“ Key Concepts**

#### **1. Allele Frequencies**

For a gene with two alleles **A and a**:

* Frequency of **A = p**
* Frequency of **a = q**

âœ… **p + q = 1**

---

#### **2. Genotype Frequencies under HWE**

| **Genotype** | **Expected Frequency** |
| ------------ | ---------------------- |
| AA           | pÂ²                     |
| Aa           | 2pq                    |
| aa           | qÂ²                     |

---

### **ğŸ”¬ Practical Example**

#### **Scenario**

In a sample of **200 individuals**, genotypes for a SNP are:

| **Genotype** | **Count** |
| ------------ | --------- |
| AA           | 90        |
| Aa           | 80        |
| aa           | 30        |

âœ… Test if the population is in **Hardy-Weinberg Equilibrium**.

---

#### **Stepwise Calculation**

1. **Calculate allele frequencies**

Total alleles = 200 x 2 = **400**

* Number of A alleles = (2 x 90) + 80 = **260**
* Number of a alleles = (2 x 30) + 80 = **140**

Thus,

* p = 260 / 400 = **0.65**
* q = 140 / 400 = **0.35**

âœ… Check: p + q = 1.0 âœ”ï¸

---

2. **Calculate expected genotype counts**

| Genotype | Expected Frequency | Expected Count          |
| -------- | ------------------ | ----------------------- |
| AA       | pÂ² = 0.4225        | 0.4225 x 200 = **84.5** |
| Aa       | 2pq = 0.455        | 0.455 x 200 = **91**    |
| aa       | qÂ² = 0.1225        | 0.1225 x 200 = **24.5** |

---

3. **Perform Chi-square test**

$$
Ï‡^2 = \sum \frac{(Observed - Expected)^2}{Expected}
$$

Calculate:

* AA: (90 â€“ 84.5)Â² / 84.5 = 0.36
* Aa: (80 â€“ 91)Â² / 91 = 1.33
* aa: (30 â€“ 24.5)Â² / 24.5 = 1.24

Total **Ï‡Â² = 0.36 + 1.33 + 1.24 = 2.93**

---

4. **Interpretation**

* **df = 1** (degrees of freedom for HWE test with bi-allelic SNP)
* **Critical value at Î±=0.05 = 3.84**

âœ… Since **2.93 < 3.84**, **no significant deviation from HWE**.

---

### **ğŸ–¥ï¸ Implementation in Python**

Using **scipy.stats module**:

```python
# Install if not installed
# pip install scipy

from scipy.stats import chisquare

# Observed counts
obs = [90,80,30]

# Total individuals
n = sum(obs)

# Calculate allele frequencies
p = (2*90 + 80) / (2*n)
q = 1 - p

# Expected counts under HWE
exp = [p**2 * n, 2*p*q * n, q**2 * n]

# Chi-square test
chi2, p_value = chisquare(obs, f_exp=exp)

print(f"Chi-square statistic: {chi2:.2f}")
print(f"p-value: {p_value:.4f}")
```

---

### **ğŸ”‘ Interpretation**

âœ… **p-value > 0.05:** Genotype distribution is **in Hardy-Weinberg Equilibrium**.

---

### **ğŸ’¡ Genetic Association Testing**

Beyond HWE testing, **genetic association analysis** compares genotype frequencies between:

âœ… **Cases (diseased)**
âœ… **Controls (non-diseased)**

Using:

* **Chi-square test** for allele/genotype association
* **Logistic regression** for adjusting covariates

*(Covered in detail in advanced genetic epidemiology modules.)*

---

### **ğŸ¯ Key Takeaways**

âœ… **Hardy-Weinberg Equilibrium** provides a baseline expectation for genotype frequencies
âœ… Deviations may indicate **errors or population issues**
âœ… Essential quality check before **genetic association analysis**

---
