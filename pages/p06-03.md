## **ğŸ§¬ Sample Size for Correlation Studies**

### **ğŸ“– Introduction**

When planning a study to measure **correlation between two continuous variables** (e.g. height and weight, blood pressure and age), it is important to calculate:

âœ… The **minimum sample size required** to detect a **specified correlation coefficient (r)**
âœ… With chosen **significance level (Î±)** and **power (1â€“Î²)**

---

### **ğŸ” When to Use**

âœ… Testing **Pearsonâ€™s correlation coefficient**
âœ… Assessing strength of association between **two continuous variables**

---

### **ğŸ“ Key Formula**

For testing correlation:

$$
n = \frac{ (Z_{\alpha/2} + Z_{\beta})^2 }{ (0.5 \times \ln \frac{1+r}{1-r})^2 } + 3
$$

Where:

* **n:** Required sample size
* **r:** Expected correlation coefficient
* **ZÎ±/2:** Z value for two-tailed Î± (e.g. 1.96 for Î±=0.05)
* **ZÎ²:** Z value for desired power (e.g. 0.84 for 80% power)

---

#### **Fisherâ€™s Z transformation**

$$
Z_r = 0.5 \times \ln \frac{1+r}{1-r}
$$

âœ… Converts r to approximately normal distribution.

---

### **ğŸ’¡ Key Concepts**

âœ… **Effect size (r):** Minimum detectable correlation coefficient
âœ… **Alpha (Î±):** Type I error rate
âœ… **Power (1â€“Î²):** Probability to detect true correlation

---

### **ğŸ”¬ Practical Example**

#### **Scenario**

A researcher plans to detect a **minimum correlation (r) of 0.30** between systolic BP and age:

* **Alpha (Î±):** 0.05 (two-tailed)
* **Power (1â€“Î²):** 80%

---

#### **Stepwise Calculation**

1. **Calculate Fisherâ€™s Zr**

$$
Z_r = 0.5 \times \ln \frac{1+0.30}{1-0.30}
= 0.5 \times \ln \frac{1.30}{0.70}
$$

$$
= 0.5 \times \ln (1.8571)
= 0.5 \times 0.6190
= 0.3095
$$

---

2. **Find ZÎ±/2 and ZÎ²**

* ZÎ±/2 = 1.96 (for Î±=0.05, two-tailed)
* ZÎ² = 0.84 (for 80% power)

---

3. **Calculate n**

$$
n = \frac{(1.96 + 0.84)^2}{0.3095^2} + 3
$$

$$
n = \frac{(2.80)^2}{0.0958} + 3
$$

$$
n = \frac{7.84}{0.0958} + 3
$$

$$
n = 81.8 + 3
= 84.8
$$

âœ… **Sample size required = 85 participants (rounded up).**

---

### **ğŸ–¥ï¸ Implementation in Python**

Using **statsmodels.stats.power module**:

```python
# Install if not installed
# pip install statsmodels

from statsmodels.stats.power import NormalIndPower

# Define parameters
r = 0.30
alpha = 0.05
power = 0.80

# Calculate effect size using Fisher's Z transformation
import numpy as np

Z_r = 0.5 * np.log((1 + r) / (1 - r))

# Calculate sample size
Z_alpha = 1.96
Z_beta = 0.84

n = ((Z_alpha + Z_beta)**2 / (Z_r**2)) + 3

print(f"Sample size required: {n:.0f}")
```

Alternatively, **statsmodels TTestIndPower or specialized correlation modules** can be used for direct computation.

---

### **ğŸ”‘ Interpretation**

âœ… **Sample size = 85** to detect a correlation of **0.30** with **80% power** at **5% significance level (two-tailed).**

---

### **ğŸ’¡ Limitations**

âŒ Assumes **bivariate normal distribution**
âŒ Sensitive to **small effect sizes**, requiring large samples

---

### **ğŸ¯ Key Takeaways**

âœ… Sample size calculation for correlation studies ensures **sufficient power to detect meaningful associations**
âœ… Depends on **expected correlation, alpha, and power**
âœ… Essential for **observational studies, clinical correlations, and epidemiological research**

---
